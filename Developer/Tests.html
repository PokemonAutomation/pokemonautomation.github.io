
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://pokemonautomation.github.io/Developer/Tests.html">
      
      
      
      
      <link rel="icon" href="../assets/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Command Line Tests - Pokémon Automation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#command-line-tests" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="Pokémon Automation" class="md-header__button md-logo" aria-label="Pokémon Automation" data-md-component="logo">
      
  <img src="../assets/original_logo_no_background.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pokémon Automation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Command Line Tests
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/PokemonAutomation/About" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    PokemonAutomation/About
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../SetupGuide/index.html" class="md-tabs__link">
        
  
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../Programs/index.html" class="md-tabs__link">
        
  
  
    
  
  Programs

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../ControllerList.html" class="md-tabs__link">
        
  
  
    
  
  Controllers

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../DiscordIntegration/index.html" class="md-tabs__link">
          
  
  
  Discord Integration

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="index.html" class="md-tabs__link">
          
  
  
  Developer

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="Pokémon Automation" class="md-nav__button md-logo" aria-label="Pokémon Automation" data-md-component="logo">
      
  <img src="../assets/original_logo_no_background.png" alt="logo">

    </a>
    Pokémon Automation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/PokemonAutomation/About" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    PokemonAutomation/About
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../SetupGuide/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../Programs/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Programs
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ControllerList.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Controllers
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Discord Integration
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Discord Integration
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DiscordIntegration/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DiscordIntegration/DiscordBot.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Discord Bot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DiscordIntegration/DiscordWebhooks.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Discord Webhooks
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Developer
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Developer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Knowledge.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Knowledge Requirement
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Git.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    How to Use Github
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="TutorialMC.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial Button Script
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="TutorialCC.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial Home Sorter
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="command-line-tests">Command Line Tests</h1>
<p><a href="https://discord.gg/cQ4gWxN"><img src="https://canary.discordapp.com/api/guilds/695809740428673034/widget.png?style=banner2"></a></p>
<p>When designing visual/audio inference methods,
developers may want to test them on some test images/audios first before adding them into a program and testing the full program.
The reason is that testing a full program is difficult:
you may need to wait quite some time for one program run, and you may need to reset the game every time.
So if we can make sure an inference function works on several test images, then it will be less likely to fail in a full program.</p>
<p>If you would like to write some inference tests, we have a <a href="https://github.com/PokemonAutomation/Arduino-Source/blob/main/SerialPrograms/Source/Tests/CommandLineTests.h">command line test framework</a>.
The framework is similar to unit tests. It can test each inference component individually.
The difference is: common unit tests have their own build targets.
But to save us the time of writing those build targets, we use the program setting JSON, named SerialPrograms-Settings.json to denote which tests to run. Apart from the command line test setting, the JSON file stores all the user inputs and preferences so that the <strong>SerialPrograms</strong> executable remembers the user data from the last session.</p>
<h2 id="use-test-framework">Use Test Framework</h2>
<p>Enable the command line test mode by changing the SerialPrograms-Settings.json field:</p>
<pre><code>&quot;20-GlobalSettings&quot;: &quot;COMMAND_LINE_TESTS&quot;: &quot;RUN&quot;
</code></pre>
<p>to true. </p>
<p>If you are testing or building with Qt creator, you can find SerialPrograms-Settings.json in the folder <code>Arduino-Source\build-SerialPrograms-Desktop_Qt_6_3_2_MSVC2019_64bit-Debug\UserSettings</code>, or something similar, depending on your version of Qt.</p>
<p>In this mode, when starting <strong>SerialPrograms</strong>, it does not launch the GUI. Instead it looks for a local folder the path of which is specified by the json field:</p>
<pre><code>&quot;20-GlobalSettings&quot;: &quot;COMMAND_LINE_TESTS&quot;: &quot;FOLDER&quot;
</code></pre>
<p>and run tests inside it.
One example path is "./CommandLineTests".</p>
<p>Tests are not included in the Arduino-Source repository. To see some examples of test files and their folder structure, see the <a href="https://github.com/PokemonAutomation/CommandLineTests">CommandLineTests</a> repository. </p>
<p>To try using these tests, the value for "FOLDER" in the json should be set to "./CommandLineTests". Download/clone the CommandLineTests from the above repository, and put this folder in the <code>Arduino-Source\build-SerialPrograms-Desktop_Qt_6_3_2_MSVC2019_64bit-Debug</code> folder.</p>
<p>Example folder structure:</p>
<pre><code>CommandLineTests/                          &lt;- root test folder. This name needs to match the folder specified in &quot;FOLDER&quot;
- PokemonLA/                               &lt;- test space, ususally which game the test belongs to.
  - BattleMenuDetector/                    &lt;- test object, name of the class/function/file to test
    - IngoBattleDayTime_True.png           &lt;- test file for BattleMenuDetector. Expected result is True.
    - IngoBattleNightTime_True.png         &lt;- test file for BattleMenuDetector. Expected result is True.
- PokemonBDSP/                             &lt;- another test space for inferences in another game
  - DialogDetector/                        &lt;- test object, this time it's DialogDetector for BDSP
    - Win_Mirabox/                         &lt;- can have more folders under test object to organize test files, e.g by OS and capture card
      - FetchEggDayTime_True.png           &lt;- test file for DialogDetector. Expected result is True.
</code></pre>
<h3 id="find-test-code-for-test-file">Find Test Code for Test File</h3>
<p>When running in the test mode, it will go to find each file in the folder recursively.
We assume each file is a test image or other test file. For each file, <strong>it uses the file path to determine which test code to call to run on the test file</strong>.</p>
<p>For example, if the path is <code>CommandLineTest/PokemonLA/BattleMenuDetector/</code>, the test framework first finds all the files inside this folder as test files.
It then finds the corresponding test code <code>test_pokemonLA_BattleMenuDetector()</code> declared in <a href="https://github.com/PokemonAutomation/Arduino-Source/blob/main/SerialPrograms/Source/Tests/PokemonLA_Tests.h">PokemonLA_Tests.h</a> and calls the test function with each test file.
To find the test code given a file path, we use a mapping defined as <code>TEST_MAP</code> in <a href="https://github.com/PokemonAutomation/Arduino-Source/blob/main/SerialPrograms/Source/Tests/TestMap.cpp">TestMap.cpp</a>.</p>
<p>The expected result for the image should be in the file name at the end. E.g. if you expect the test result on the image should be true, the image name should end with <code>_True</code>.</p>
<h3 id="hidden-files">"Hidden" Files</h3>
<p>In the test folder, filenames starting with "_" are considered "hidden" files and are ignored by the test framework when searching for files.
Those "hidden" files are useful for storing some metadata in the folder.</p>
<p>They can also be used as an extra file in case some tests need more than one test file.
For example, we would like to read some Pokémon from Pokémon sprites on an image.
There are many Pokémon sprites, so we would like to save the target Pokémon <a href="Slug.html">slugs</a> in a text file.
(This kind of file is also called "golden file" by some engineers: the file contains the desired code output that
the engineers need to fix the code to match.)
This means one test of sprite reading involves two files (one image and one text).
We set the text filename to start with "_" so the test framework only finds the image file and 
run the test function with the image file path as the input argument.
Inside the function we can then use the input image file path to find the text file path and load the target Pokémon slugs.</p>
<h3 id="select-tests">Select Tests</h3>
<p>You can also selectively run a subset of the tests by setting</p>
<pre><code>&quot;20-GlobalSettings&quot;: &quot;COMMAND_LINE_TESTS&quot;: &quot;TEST_LIST&quot;
</code></pre>
<p>as a list of strings. Each string will be a relative path. Example types of the path can be any of:</p>
<ul>
<li>"PokemonBDSP"</li>
<li>"PokemonBDSP/DialogDetector"</li>
<li>"PokemonBDSP/DialogDetector/Win_Mirabox"</li>
<li>"PokemonBDSP/DialogDetector/Win_Mirabox/FetchEggDayTime_True.png"</li>
</ul>
<p>This gives the flexibility to test the code for a game, a detector, a detector on a capture card or a detector on a particular image.</p>
<h3 id="ignore-tests">Ignore Tests</h3>
<p>If you have put some test files for experimental code in a folder and later decide to not run that code for a while,
you can use</p>
<pre><code>&quot;20-GlobalSettings&quot;: &quot;COMMAND_LINE_TESTS&quot;: &quot;IGNORE_LIST&quot;
</code></pre>
<p>as a list of strings to skip the paths to those tests.</p>
<p>Each string in the list serves as a prefix to the test path that the test framework uses to filter out paths.</p>
<h2 id="add-new-tests">Add New Tests</h2>
<p>When adding new tests, add the new test function to both <code>Tests.cpp</code> and <code>Tests.h</code>, as well as to <code>TestMap.cpp</code>.</p>
<p>For example, in order to implement a test for BattleMenuDetector:</p>
<ul>
<li>Implement a ScreenBoolDetectorFunction, <code>test_pokemonLA_BattleMenuDetector()</code> that calls the detector code and compares the result with the target bool. The implementation is written in <code>PokemonLA_Tests.cpp</code>.</li>
<li>Write the function declaration in <code>PokemonLA_Tests.h</code></li>
<li>Add a new entry to <code>TestMap.cpp:TEST_MAP</code> by utilizing screen_bool_detector_helper:
<code>{"PokemonLA_BattleMenuDetector", std::bind(screen_bool_detector_helper, test_pokemonLA_BattleMenuDetector, _1)}</code></li>
</ul>
<p>You can read the code of existing test functions like <code>test_pokemonLA_BattleMenuDetector()</code> to know how to write test code.</p>
<h3 id="how-the-test-framework-works">How the test framework works</h3>
<p>The test framework calls <a href="https://github.com/PokemonAutomation/Arduino-Source/blob/main/SerialPrograms/Source/Tests/TestMap.h"><code>find_test_function(test_space, test_obj_name)</code></a> to find the test function related to a test path.</p>
<p>For example, given a path <code>PokemonLA/BattleMenuDetector/IngoBattleDayTime_True.png</code>, by extracting <code>test_space</code> as "PokemonLA" and <code>test_obj_name</code> as "BattleMenuDetector" from the path,</p>
<p><code>find_test_function()</code> returns the test code <code>test_pokemonLA_BattleMenuDetector()</code> declared in <a href="https://github.com/PokemonAutomation/Arduino-Source/blob/main/SerialPrograms/Source/Tests/PokemonLA_Tests.h">PokemonLA_Tests.h</a>.</p>
<p>Internally, <code>find_test_function()</code> searches in a map: <code>std::map&lt;std::string, TestFunction&gt; TEST_MAP</code> to get the correct test function.
The key of the map in the above example is "PokemonLA_BattleMenuDetector" (we use "_" to connect test space and test obj name).
The value type of the map is <code>TestFunction = std::function&lt;int(const std::string&amp; test_file_path)&gt;.</code> This is the test function.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.sections", "navigation.expand", "toc.integrate", "search.suggest", "search.highlight"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>